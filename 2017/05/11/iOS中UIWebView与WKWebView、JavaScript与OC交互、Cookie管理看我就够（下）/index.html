<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰ | Dark Angel</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/8.5/styles/github.min.css">
  <meta name="generator" content="Dark Angel">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) center; background-size: cover" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/avatar.jpg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Dark Angel</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2017-05-11T06:25:40.000Z" itemprop="datePublished">
          2017-05-11
      </time>
    
    
    | 
    <a href='/tags/iOSæŠ€æœ¯åˆ†äº«/'>iOSæŠ€æœ¯åˆ†äº«</a>
    
    
</span>
    <h1 class="post-title">iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰</h1>
    <span id="busuanzi_value_page_pv"></span>æ¬¡é˜…è¯»
    <span class="ds-thread-count" data-thread-key="2017/05/11/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰/"></span>
    <section class="post-content">
     	
              <div id="toc" class="toc-article">
                <strong class="toc-title">æœ¬æ–‡ç›®å½•</strong>
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰è¨€"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Safariè°ƒè¯•"><span class="toc-text">Safariè°ƒè¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å¼€å¯Safariå¼€å‘èœå•"><span class="toc-text">å¼€å¯Safariå¼€å‘èœå•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iPhoneå¼€å¯Webæ£€æŸ¥å™¨"><span class="toc-text">iPhoneå¼€å¯Webæ£€æŸ¥å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è¿è¡ŒApp"><span class="toc-text">è¿è¡ŒApp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è°ƒè¯•å¯¹åº”çš„é¡µé¢"><span class="toc-text">è°ƒè¯•å¯¹åº”çš„é¡µé¢</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä¸å‰ç«¯é…åˆè§£å†³bug"><span class="toc-text">ä¸å‰ç«¯é…åˆè§£å†³bug</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°"><span class="toc-text">å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#è‡ªå®šä¹‰æµè§ˆå™¨UserAgent"><span class="toc-text">è‡ªå®šä¹‰æµè§ˆå™¨UserAgent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€"><span class="toc-text">Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image"><span class="toc-text">Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ†æ"><span class="toc-text">åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ¡ˆ"><span class="toc-text">æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UIWebViewå®ç°"><span class="toc-text">UIWebViewå®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WKWebViewå®ç°"><span class="toc-text">WKWebViewå®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ³¨æ„"><span class="toc-text">æ³¨æ„</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img"><span class="toc-text">NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰"><span class="toc-text">Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nativeä¸ºH5æä¾›ä¸€å¥—Native-Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰"><span class="toc-text">Nativeä¸ºH5æä¾›ä¸€å¥—Native Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ†äº«"><span class="toc-text">åˆ†äº«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº"><span class="toc-text">ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ‰«æäºŒç»´ç "><span class="toc-text">æ‰«æäºŒç»´ç </span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ€»ç»“"><span class="toc-text">æ€»ç»“</span></a></li></ol>
              </div>
            
	 <p><img src="http://ww4.sinaimg.cn/large/006tNc79ly1fff1sa06wrj30sg0iwwi9.jpg" alt=""></p>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†<code>UIWebView</code>ã€<code>WKWebView</code>ä¸€äº›ä½¿ç”¨ï¼Œä¸JSçš„äº¤äº’å’Œä¸€äº›å‘ï¼Œç›¸ä¿¡çœ‹è¿‡çš„å°ä¼™ä¼´ä»¬ï¼Œå·²ç»å¤§æ¦‚æ¸…æ¥šäº†å§ï¼Œå¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿æé—®ã€‚</p>
<p>æœ¬æ–‡æ˜¯æœ¬ç³»åˆ—æ–‡ç« çš„æœ€åä¸€ç¯‡ï¼Œä¸»è¦ä¸ºå°ä¼™ä¼´ä»¬åˆ†äº«ä¸‹<strong>Safariè°ƒè¯•</strong>ã€<strong>ä¸å‰ç«¯çš„é…åˆ</strong>ä»¥åŠ<strong>å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°ç­‰</strong>ï¼š</p>
<ul>
<li><a href="http://blog.darkangel7.com/2016/09/01/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸Šï¼‰/">iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸Šï¼‰</a></li>
<li><a href="http://blog.darkangel7.com/2017/05/10/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸­ï¼‰/">iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸­ï¼‰</a></li>
<li>iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰</li>
</ul>
<p>å…³äºæ–‡ä¸­æåˆ°çš„ä¸€äº›å†…å®¹ï¼Œè¿™é‡Œæˆ‘å‡†å¤‡äº†ä¸ª<a href="https://github.com/DarkAngel7/Demos-WebViewDemo" target="_blank" rel="external">Demo</a>ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´å¯ä»¥ä¸‹è½½ã€‚</p>
<h1 id="Safariè°ƒè¯•"><a href="#Safariè°ƒè¯•" class="headerlink" title="Safariè°ƒè¯•"></a>Safariè°ƒè¯•</h1><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼ŒæŸ¥çœ‹ç½‘é¡µçš„Cookieï¼Œå…¶å®å·²ç»ç”¨åˆ°äº†Safariè°ƒè¯•ã€‚ç¬”è€…è§‰å¾—Safariè°ƒè¯•åŠŸèƒ½çœŸçš„å¾ˆæœ‰ç”¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è½»æ¾å®šä½é—®é¢˜çš„æ‰€åœ¨ã€‚ä¹Ÿå› æ­¤ï¼Œå…¬å¸ä¸­Appä¸€æ—¦æœ‰é—®é¢˜å‡ºç°ï¼Œä¸ç®¡æ˜¯å®¢æˆ·ç«¯çš„é—®é¢˜ï¼Œè¿˜æ˜¯å‰ç«¯çš„é—®é¢˜ï¼Œæ‰¾é—®é¢˜çš„é‡ä»»éƒ½è½åˆ°äº†ç¬”è€…çš„èº«ä¸Šå‘¢ã€‚è¿™ä¸€åº¦æ˜¯ä¸€ä¸ªå›°æ‰°ğŸ˜ªã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œh5é¡µé¢çš„ä¸€ä¸ªbugï¼ŒAppç«¯å¸®å¿™å¿«é€Ÿå®šä½ï¼Œå¹¶ä¸”å‘ŠçŸ¥h5ç›¸å…³å¼€å‘äººå‘˜è¯¥å¦‚ä½•ä¿®å¤ï¼Œæ˜¯å¤šä¹ˆä¼Ÿå¤§çš„ä¸€ä»¶äº‹æƒ…ã€‚</p>
<p>ä¸‹é¢æ¥ç®€å•è®²è®²æ€ä¹ˆç”¨Safariè°ƒè¯•ã€‚</p>
<h2 id="å¼€å¯Safariå¼€å‘èœå•"><a href="#å¼€å¯Safariå¼€å‘èœå•" class="headerlink" title="å¼€å¯Safariå¼€å‘èœå•"></a>å¼€å¯Safariå¼€å‘èœå•</h2><p>åœ¨Macçš„Safariåå¥½è®¾ç½®ä¸­ï¼Œå¼€å¯å¼€å‘èœå•ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š<strong>Safari -&gt; åå¥½è®¾ç½®â€¦ -&gt; é«˜çº§ -&gt; å‹¾é€‰åœ¨èœå•æ æ˜¾ç¤ºâ€œå¼€å‘â€èœå•</strong>ã€‚</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhhv5gt96j31as0w0dus.jpg" alt="B49417E2-433A-4650-8BF7-AF941E8B6670"></p>
<h2 id="iPhoneå¼€å¯Webæ£€æŸ¥å™¨"><a href="#iPhoneå¼€å¯Webæ£€æŸ¥å™¨" class="headerlink" title="iPhoneå¼€å¯Webæ£€æŸ¥å™¨"></a>iPhoneå¼€å¯Webæ£€æŸ¥å™¨</h2><p>å…·ä½“æ­¥éª¤ä¸ºï¼š<strong>è®¾ç½® -&gt; Safari -&gt; é«˜çº§ -&gt; Web æ£€æŸ¥å™¨</strong>ã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwly1ffhi80ocj7j31kw0yugzs.jpg" alt="8AECBA1E-FF4A-4D7F-8D74-E224035EA418"></p>
<h2 id="è¿è¡ŒApp"><a href="#è¿è¡ŒApp" class="headerlink" title="è¿è¡ŒApp"></a>è¿è¡ŒApp</h2><p>æ‰“å¼€é¡¹ç›®ï¼ŒCmd + R è¿è¡Œï¼Œæ‰“å¼€æƒ³è°ƒè¯•çš„Webé¡µé¢ã€‚</p>
<p><img src="http://ww4.sinaimg.cn/large/006tNbRwly1ffhiit6h9oj30ku12agvo.jpg" width="30%"></p>
<h2 id="è°ƒè¯•å¯¹åº”çš„é¡µé¢"><a href="#è°ƒè¯•å¯¹åº”çš„é¡µé¢" class="headerlink" title="è°ƒè¯•å¯¹åº”çš„é¡µé¢"></a>è°ƒè¯•å¯¹åº”çš„é¡µé¢</h2><p>æ‰“å¼€<strong>Safari -&gt; å¼€å‘ -&gt; è®¾å¤‡ -&gt; URLã€‚</strong></p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwly1ffhiovms7ej31kw0w2kjl.jpg" alt="5B046813-A658-45B4-9ED2-A1480BA5EE99"></p>
<p>é€‰ä¸­çš„é¡µé¢ä¼šå˜æˆè“è‰²ï¼Œç‚¹å‡»ç„¶åæ‰“å¼€äº†å¦‚ä¸‹çš„ç•Œé¢ã€‚</p>
<p><img src="http://ww2.sinaimg.cn/large/006tNbRwly1ffhiqs8pnnj31jk104wx4.jpg" alt="693A55F1-ADD7-4D84-B8D1-4B669D3CF561"></p>
<p>è¿™ä¸ªé¡µé¢å°±å¾ˆåƒ<code>Windows</code> å¹³å°<code>Chrome</code>çš„<code>F12</code>ã€‚å¯ä»¥æ‰“æ–­ç‚¹ï¼š</p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwly1ffhjiak74qj31jk1044df.jpg" alt="7A23FD0A-40A9-48D9-B53E-B721F455C1D5"></p>
<p>æŸ¥çœ‹æ–­ç‚¹</p>
<p><img src="http://ww2.sinaimg.cn/large/006tNbRwly1ffhjk62o3bj31jk104gxb.jpg" alt="E2ABC34F-D227-4A71-AC0C-7C3AC9B730F9"></p>
<p>æŸ¥çœ‹Cookie</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhjl2y69zj31jk104n6a.jpg" alt="0E90DD8A-B178-4EF3-BF8C-F90C6E3A278F"></p>
<p>æ‰“å°Cookieæˆ–è€…å…ƒç´ <br><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhjmbt52kj31jk104tgk.jpg" alt="834DB431-32B4-44EC-BED2-05E3D124FFBA"></p>
<p>æ¯”å¦‚æˆ‘åœ¨è¿™é‡ŒAlerté¡µé¢çš„titleï¼Œè¾“å…¥ <code>alert(document.title);</code>ï¼Œä½ ä¼šåœ¨æ¨¡æ‹Ÿå™¨ä¸­çœ‹åˆ°å¼¹çª—</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhjo6usmvj31j40zkart.jpg" alt="550D157D-0F2E-41E1-B5E3-85928FFCBCAC"></p>
<p>æ•´ä½“ååˆ†æœ‰ç”¨ï¼Œæ“ä½œçš„ä½“éªŒè·Ÿ<code>Xcode</code>å¾ˆåƒï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œæ¢ç´¢ã€‚</p>
<h1 id="ä¸å‰ç«¯é…åˆè§£å†³bug"><a href="#ä¸å‰ç«¯é…åˆè§£å†³bug" class="headerlink" title="ä¸å‰ç«¯é…åˆè§£å†³bug"></a>ä¸å‰ç«¯é…åˆè§£å†³bug</h1><p>å‰ç«¯æœ‰ä¸€äº›é—®é¢˜ï¼Œåœ¨æµè§ˆå™¨ä¸­æ˜¯æ— æ³•è°ƒè¯•çš„ï¼Œå¾ˆå¯èƒ½åªåœ¨Appå†…çš„æµè§ˆå™¨ä¸­æ‰ä¼šå¤ç°ã€‚è¿™ä¸ªæ—¶å€™ä½ å¯ä»¥æœŸå¾…å‰ç«¯å¼€å‘äººå‘˜ä¼šä½¿ç”¨<code>Xcode</code>å’Œ<code>Safari</code>è°ƒè¯•æ¥è§£å†³bugï¼Œæˆ–è€…é è‡ªå·±ã€‚æ¯•ç«Ÿå¤§å®¶çš„ç›®æ ‡ä¸€è‡´ï¼Œç»™ç”¨æˆ·æä¾›ä¸€ä¸ªæ›´å¥½çš„Appï¼Œè§£å†³æ‰€æœ‰å·²çŸ¥é—®é¢˜ã€‚</p>
<p>è¿™é‡Œæˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œè¿ç”¨Safariè°ƒè¯•æ¥è§£å†³ä¸€ä¸ªå‰ç«¯çš„bugã€‚</p>
<p>æ¯”å¦‚æ–°åšçš„h5é¡µé¢ä¸­ï¼Œæœ‰ä¸€ä¸ªåˆ†äº«æŒ‰é’®ï¼Œç‚¹å‡»è°ƒç”¨åŸç”Ÿçš„åˆ†äº«ï¼Œä½†æ˜¯å‘ç°ï¼Œç‚¹å‡»ä¹‹åæ²¡æœ‰ååº”äº†ï¼Œä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæ˜¯Nativeç«¯å®ç°æœ‰é—®é¢˜ï¼Œè¿˜æ˜¯å‰ç«¯å†™çš„æœ‰é—®é¢˜å‘¢ï¼Ÿå¦‚å›¾</p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwly1ffhjxcad71j30ko0gy75u.jpg" width="30%"></p>
<p>æˆ‘ä»¬æ¥å¸®å¿™çœ‹ä¸‹å§ï¼Œæ‰“å¼€Safari <strong>Web æ£€æŸ¥å™¨</strong>ï¼Œå®šä½åˆ°èµ„æºï¼Œå¹¶ä¸”åœ¨shareæ–¹æ³•ä¸­æ·»åŠ æ–­ç‚¹ï¼Œå¦‚å›¾</p>
<p><img src="http://ww1.sinaimg.cn/large/006tNbRwly1ffhk1xng71j31jk1044ag.jpg" alt="76A2E384-0A07-4DA0-8D5C-61DB988C4AE0"></p>
<p>ä¼šå‘ç°ï¼Œå¹¶æ²¡æœ‰æ–­ä½ï¼Œè€Œæ˜¯é¡µé¢ç›´æ¥æŠ¥é”™äº†ï¼Œä»”ç»†æŸ¥çœ‹é”™è¯¯æè¿°ï¼Œshareæ–¹æ³•é‡Œå¤šäº†ä¸€ä¸ª<code>â€œ/â€</code>ï¼Œå› æ­¤æŠ¥é”™äº†ã€‚å½“æˆ‘ç‚¹å‡»åˆ†äº«æŒ‰é’®æ—¶<img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhk3hpu55j312q036aaw.jpg" alt="6792A001-7ACC-4336-BF1E-6A03983C74E1">ä¼šå‘ç°ï¼Œæç¤ºæ‰¾ä¸åˆ°å˜é‡<code>share</code>ã€‚è¿™é‡Œæˆ‘éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼š</p>
<blockquote>
<p>å½“jsä¸­æŠ¥é”™çš„æ—¶å€™ï¼ŒæŠ¥é”™ä½ç½®æ‰€åœ¨çš„å‡½æ•°ä»¥åŠæŠ¥é”™ä½ç½®ä¹‹åçš„ä»£ç ï¼Œéƒ½ä¸ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ç‚¹å‡»åˆ†äº«æ—¶ï¼Œæç¤ºçš„æ˜¯æ‰¾ä¸åˆ°æ–¹æ³•ï¼Œå› ä¸ºjsçš„è¯­æ³•ä¸å¯¹ï¼ŒæŠ¥é”™äº†ï¼Œè¿™é‡Œè§£æä¸å‡ºæ¥ï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡æœ‰äº†<code>share</code>ã€<code>testAddMethod</code>å’Œä¹‹åçš„å‡½æ•°ã€‚</p>
<p>é‚£ä¹ˆå½“æˆ‘ç‚¹å‡»åˆ†äº«ä¸‹é¢çš„æŒ‰é’®æ˜¯ï¼Œè°ƒç”¨shareä¸‹é¢å®šä¹‰çš„æ–¹æ³•ä¹Ÿå°±ä¼šæç¤ºæ‰¾ä¸åˆ°å¯¹åº”çš„å‡½æ•°äº†ã€‚<img src="http://ww2.sinaimg.cn/large/006tNbRwly1ffhk6n0oozj30ko02mwen.jpg" width="50%"></p>
<p><img src="http://ww2.sinaimg.cn/large/006tNbRwly1ffhk88lyzkj311i03o76a.jpg" alt=""></p>
</blockquote>
<p>è‡³æ­¤ï¼Œé—®é¢˜æ‰¾åˆ°äº†ï¼Œåªè¦å‘Šä¹‹å‰ç«¯å¼€å‘äººå‘˜å³å¯ï¼Œè®©ä»–ä¿®å¤å³å¯ã€‚</p>
<p>å®é™…é‡åˆ°çš„é—®é¢˜å¯èƒ½è¦å¤æ‚çš„å¤šï¼Œå¯ä»¥é€šè¿‡æ–­ç‚¹ï¼Œä»¥åŠæ§åˆ¶å°æ‰“å°ä¸€äº›jså˜é‡çš„å€¼ï¼ŒDOMæ“ä½œæ¥å¯»æ‰¾é—®é¢˜ï¼Œè§£å†³é—®é¢˜ã€‚å¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°å°ä¼™ä¼´ä»¬ã€‚</p>
<h1 id="å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°"><a href="#å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°" class="headerlink" title="å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°"></a>å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°</h1><h2 id="è‡ªå®šä¹‰æµè§ˆå™¨UserAgent"><a href="#è‡ªå®šä¹‰æµè§ˆå™¨UserAgent" class="headerlink" title="è‡ªå®šä¹‰æµè§ˆå™¨UserAgent"></a>è‡ªå®šä¹‰æµè§ˆå™¨UserAgent</h2><p>è¿™ä¸ªå…¶å®åœ¨Appå¼€å‘ä¸­ï¼Œæ¯”è¾ƒé‡è¦ã€‚æ¯”å¦‚å¸¸è§çš„å¾®ä¿¡ã€æ”¯ä»˜å®Appç­‰ï¼Œéƒ½æœ‰è‡ªå·±çš„<code>UserAgent</code>ï¼Œè€ŒUAæœ€å¸¸ç”¨æ¥åˆ¤æ–­åœ¨å“ªä¸ªAppå†…ï¼Œä¸€èˆ¬Appçš„ä¸‹è½½é¡µä¸­åªæœ‰ä¸€ä¸ªæŒ‰é’®â€ç‚¹å‡»ä¸‹è½½â€ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¯¥æŒ‰é’®æ—¶ï¼Œåœ¨å¾®ä¿¡ä¸­åˆ™è·³è½¬åˆ°åº”ç”¨å®ï¼Œå¦åˆ™è·³è½¬åˆ°AppStoreã€‚é‚£ä¹ˆå¦‚ä½•åŒºåˆ†åœ¨å“ªä¸ªAppä¸­å‘¢ï¼Ÿå°±æ˜¯jsåˆ¤æ–­UAã€‚</p>
<pre><code class="javascript">//jsä¸­åˆ¤æ–­
if (navigator.userAgent.indexOf(&quot;MicroMessenger&quot;) !== -1) {
   //åœ¨å¾®ä¿¡ä¸­
}
</code></pre>
<p>å…³äºè‡ªå®šä¹‰UAï¼Œè¿™ä¸ª<code>UIWebView</code>ä¸æä¾›Apiï¼Œè€Œ<code>WKWebView</code>æä¾›Apiï¼Œå‰æ–‡ä¸­ä¹Ÿè¯´æ˜è¿‡ï¼Œå°±æ˜¯è°ƒç”¨<code>customUserAgent</code>å±æ€§ã€‚</p>
<pre><code class="objective-c">self.webView.customUserAgent = @&quot;WebViewDemo/1.0.0&quot;;    //è‡ªå®šä¹‰UAï¼Œåªæ”¯æŒWKWebView
</code></pre>
<p>è€Œæœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•å®ç°è‡ªå®šä¹‰æµè§ˆå™¨UserAgentå‘¢ï¼Ÿæœ‰ã€‚</p>
<pre><code class="objective-c">//æœ€å¥½åœ¨AppDelegateä¸­å°±æå‰è®¾ç½®
@implementation AppDelegate


- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    // Override point for customization after application launch.

    //è®¾ç½®è‡ªå®šä¹‰UserAgent
    [self setCustomUserAgent];
    return YES;
}

- (void)setCustomUserAgent
{
    //get the original user-agent of webview
    UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectZero];
    NSString *oldAgent = [webView stringByEvaluatingJavaScriptFromString:@&quot;navigator.userAgent&quot;];
    //add my info to the new agent
    NSString *newAgent = [oldAgent stringByAppendingFormat:@&quot; %@&quot;, @&quot;WebViewDemo/1.0.0&quot;];
    //regist the new agent
    NSDictionary *dictionnary = [[NSDictionary alloc] initWithObjectsAndKeys:newAgent, @&quot;UserAgent&quot;, newAgent, @&quot;User-Agent&quot;, nil];
    [[NSUserDefaults standardUserDefaults] registerDefaults:dictionnary];
}

@end
</code></pre>
<p>ä¸Šé¢çš„ä»£ç ï¼Œå±•ç¤ºäº†åœ¨åŸæœ‰<code>UserAgent</code>çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„å†…å®¹ã€‚</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhl5fhh31j31jq0b8tca.jpg" alt="6F9FAD1A-DBD6-4FA6-89CC-28921D57646E"></p>
<p>å¯ä»¥çœ‹åˆ°åŸæœ¬çš„UAåé¢å·²ç»æœ‰æˆ‘ä»¬æ·»åŠ çš„å†…å®¹äº†<code>WebViewDemo/1.0.0</code>ã€‚</p>
<p>è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼š</p>
<blockquote>
<ol>
<li>é€šè¿‡<code>NSUserDefaults</code>è®¾ç½®è‡ªå®šä¹‰UserAgentï¼Œå¯ä»¥åŒæ—¶ä½œç”¨äº<code>UIWebView</code>å’Œ<code>WKWebView</code>ã€‚</li>
<li><code>WKWebView</code>çš„<code>customUserAgent</code>å±æ€§ï¼Œä¼˜å…ˆçº§é«˜äº<code>NSUserDefaults</code>ï¼Œå½“åŒæ—¶è®¾ç½®æ—¶ï¼Œæ˜¾ç¤º<code>customUserAgent</code>çš„å€¼ã€‚å¦‚ä¸Šå›¾ã€‚</li>
</ol>
</blockquote>
<h2 id="Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€"><a href="#Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€" class="headerlink" title="Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€"></a>Nativeä¸H5å…±äº«ç™»å½•çŠ¶æ€</h2><p>è¿™ä¸ªéœ€æ±‚åœ¨å‰é¢çš„æ–‡ç« ä¸­é’ˆå¯¹<code>WKWebView</code>å’Œ<code>UIWebView</code>åˆ†åˆ«å•ç‹¬åšè¿‡ä»‹ç»ã€‚ç»´æŒç™»å½•çŠ¶æ€ï¼Œä¾èµ–çš„æ˜¯ç›¸åŒçš„<code>Cookie</code>ã€‚</p>
<p><code>UIWebView</code>å®ç°èµ·æ¥åŸºæœ¬ä¸éœ€è¦åšé¢å¤–çš„æ“ä½œï¼Œåªè¦ä¿è¯<code>sharedHTTPCookieStorage</code>ä¸­çš„<code>Cookie</code>æ˜¯æ²¡é—®é¢˜çš„ã€‚</p>
<p><code>WKWebView</code>å®ç°èµ·æ¥ç›¸å¯¹éº»çƒ¦ï¼Œæœ‰å¾ˆå¤šå‘ï¼Œè¿™é‡Œä¸å†è¯¦ç»†æè¿°ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥çœ‹ä¸‹ä¸Šç¯‡æ–‡ç« ä¸­<strong>Cookieç®¡ç†</strong>ä¸€èŠ‚ã€‚</p>
<h2 id="Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image"><a href="#Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image" class="headerlink" title="Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image"></a>Nativeé¢„è§ˆH5é¡µé¢ä¸­çš„image</h2><p>è¿™ä¸ªéœ€æ±‚ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„éœ€æ±‚ã€‚åœ¨å¾®ä¿¡ä¸­æµè§ˆç½‘é¡µæ—¶ï¼Œçœ‹åˆ°å–œæ¬¢çš„å›¾ç‰‡ï¼Œä½ ä¼šç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾ï¼Œç„¶åé•¿æŒ‰å›¾ç‰‡ä¿å­˜ã€‚</p>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>å¦‚æœä½ çš„é¡¹ç›®ä¸­æœ‰è¿™æ ·çš„éœ€æ±‚çš„è¯ï¼Œå¯èƒ½ä½ éœ€è¦åšå¦‚ä¸‹çš„åˆ†æã€‚</p>
<blockquote>
<ol>
<li>å¦‚æœæƒ³åœ¨Nativeé¢„è§ˆH5ä¸­çš„imageï¼Œæœ€éœ€è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å›¾ç‰‡çš„é“¾æ¥ã€‚å¦‚æœèƒ½æœ‰ç¼©ç•¥å›¾æ›´å¥½äº†ã€‚</li>
<li>åªè¦è·å–äº†é“¾æ¥ï¼Œå°±å¯ä»¥è·³è½¬åˆ°ä¸€ä¸ª<code>ViewController</code>ä¸­ï¼Œé¢„è§ˆå›¾ç‰‡ï¼Œåç»­é•¿æŒ‰ä¿å­˜è‡ªç„¶æ°´åˆ°æ¸ æˆã€‚</li>
<li>é‚£åº”è¯¥å¦‚ä½•è·å–å›¾ç‰‡çš„é“¾æ¥å‘¢ï¼Ÿé€šè¿‡JS -&gt; OC ä¼ é€’å›¾ç‰‡urlã€‚</li>
</ol>
</blockquote>
<p>è¿™é‡Œï¼Œç©¶ç«Ÿå¦‚ä½•å®ç°è·å–å›¾ç‰‡é“¾æ¥ï¼Œå–å†³äºä½ ç”¨çš„æ˜¯<code>UIWebView</code>è¿˜æ˜¯<code>WKWebView</code>ã€‚</p>
<h3 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h3><blockquote>
<p>å½“é¡µé¢<strong>åŠ è½½å®Œæˆå</strong>ï¼Œç»™htmlé¡µé¢ä¸­æ‰€æœ‰<strong>æ— é»˜è®¤ç‚¹å‡»äº‹ä»¶</strong>çš„<code>&lt;img&gt;</code><strong>æ·»åŠ ç‚¹å‡»äº‹ä»¶</strong>ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œæ‹¿åˆ°æ‰€æœ‰å‚æ•°ã€‚</p>
<p>ï¼ˆå…¶å®è¿™ä¸æ˜¯æœ€å¥½çš„æ–¹æ¡ˆï¼Œæœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œè·Ÿå‰ç«¯çº¦å®šä¸€ä¸‹ï¼Œå“ªäº›å›¾ç‰‡éœ€è¦é¢„è§ˆï¼Œå“ªäº›imgæ ‡ç­¾çš„idç»Ÿä¸€ï¼Œæˆ–è€…æœ‰ä¸ªç‰¹å®šçš„å±æ€§ï¼Œè¿™æ ·å®¢æˆ·ç«¯å¯ä»¥æ ¹æ®idæ‰¾åˆ°è¿™äº›imgæ ‡ç­¾ï¼‰</p>
</blockquote>
<p>é¦–å…ˆï¼ŒHtmlä¸­æœ‰ä¸ªimgæ ‡ç­¾</p>
<pre><code class="html">&lt;img src=&quot;http://cc.cocimg.com/api/uploads/170425/b2d6e7ea5b3172e6c39120b7bfd662fb.jpg&quot;&gt;
</code></pre>
<p>æˆ‘å…ˆå†™å¥½ä¸€ä¸ª<code>ImgAddClickEvent.js</code>æ–‡ä»¶ï¼Œæ¥å®ç°ç»™æ‰€æœ‰æ— é»˜è®¤ç‚¹å‡»äº‹ä»¶çš„<code>&lt;img&gt;</code>æ·»åŠ ç‚¹å‡»äº‹ä»¶ã€‚</p>
<pre><code class="javascript">//è·å–æ‰€æœ‰imgæ ‡ç­¾
var imgs = document.getElementsByTagName(&quot;img&quot;);
//è·å–æ‰€æœ‰çš„imgUrl
var imgUrls = new Array();
var x = 0;
var y = 0;
var width = 0;
var height = 0;
for (var i = 0; i &lt; imgs.length; i++) {
    var img = imgs[i];
    //å¦‚æœå›¾ç‰‡é“¾æ¥å­˜åœ¨
    if (img.src || img.getAttribute(&#39;data-src&#39;)) {
        //æ·»åŠ åˆ°å›¾ç‰‡é“¾æ¥æ•°ç»„ä¸­
        imgUrls.push(img.src || img.getAttribute(&#39;data-src&#39;));
        //å¦‚æœå›¾ç‰‡æ²¡æœ‰é»˜è®¤çš„onclickäº‹ä»¶ï¼Œä¸”çˆ¶å…ƒç´ ä¸æ˜¯aæ ‡ç­¾ï¼Œåˆ™æ·»åŠ onclickäº‹ä»¶ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼ŒæŠŠå›¾ç‰‡é“¾æ¥å›ä¼ ç»™Native
        if (!img.onclick &amp;&amp; img.parentElement.tagName !== &quot;A&quot;) {
            //ç»™å›¾ç‰‡æ·»åŠ ä¸‹æ ‡çš„å±æ€§
            img.index = i; //è®°å½•ä¸‹æ ‡
            //æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œå¹¶ä¸”å›ä¼ é€‰ä¸­çš„å›¾ç‰‡é“¾æ¥ã€ä¸‹æ ‡ã€å±å¹•ä¸Šçš„ä½ç½®ã€å…¨éƒ¨çš„å›¾ç‰‡æ•°ç»„ç­‰
            img.onclick = function() {
                x = this.getBoundingClientRect().left;
                y = this.getBoundingClientRect().top;
                x = x + document.documentElement.scrollLeft;
                y = y + document.documentElement.scrollTop;
                width = this.width;
                height = this.height;
                var imgInfo = {
                    imgUrl: this.src || this.getAttribute(&#39;data-src&#39;),
                    x: x,
                    y: y,
                    width: width,
                    height: height,
                    index: this.index,
                    imgUrls: imgUrls
                };
                //UIWebViewä½¿ç”¨
                h5ImageDidClick(imgInfo);
            }
        }
    }
}

function h5ImageDidClick(info) {
    //WKWebViewä½¿ç”¨
    window.webkit.messageHandlers.imageDidClick.postMessage(info);
}
</code></pre>
<p>ä¸‹é¢åˆ†åˆ«ä»‹ç»<code>UIWebView</code>å’Œ<code>WKWebView</code>å¦‚ä½•å®ç°ã€‚</p>
<h3 id="UIWebViewå®ç°"><a href="#UIWebViewå®ç°" class="headerlink" title="UIWebViewå®ç°"></a>UIWebViewå®ç°</h3><p><code>UIWebView</code>ç›´æ¥ä½¿ç”¨<code>JavaScriptCore</code>ç»™<code>&lt;img&gt;</code>æ·»åŠ <code>onclick</code>æ–¹æ³•ä¸ºOCçš„å®ç°å³å¯ã€‚</p>
<pre><code class="objective-c">- (void)webViewDidFinishLoad:(UIWebView *)webView {
    [self convertJSFunctionsToOCMethods];
}

- (void)convertJSFunctionsToOCMethods {
    //è·å–è¯¥UIWebviewçš„javascriptä¸Šä¸‹æ–‡
    //selfæŒæœ‰jsContext
    //@property (nonatomic, strong) JSContext *jsContext;
    self.jsContext = [self.webView valueForKeyPath:@&quot;documentView.webView.mainFrame.javaScriptContext&quot;];

      //å…ˆæ³¨å…¥ç»™å›¾ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶çš„js
    //é˜²æ­¢é¢‘ç¹IOæ“ä½œï¼Œé€ æˆæ€§èƒ½å½±å“
    static NSString *jsSource;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        jsSource = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@&quot;ImgAddClickEvent&quot; ofType:@&quot;js&quot;] encoding:NSUTF8StringEncoding error:nil];
    });
    [self.jsContext evaluateScript:jsSource];
    //æ›¿æ¢å›è°ƒæ–¹æ³•
    self.jsContext[@&quot;h5ImageDidClick&quot;] = ^(NSDictionary *imgInfo) {
        NSLog(@&quot;UIWebViewç‚¹å‡»äº†htmlä¸Šçš„å›¾ç‰‡ï¼Œä¿¡æ¯æ˜¯ï¼š%@&quot;, imgInfo);
    };
}
</code></pre>
<h3 id="WKWebViewå®ç°"><a href="#WKWebViewå®ç°" class="headerlink" title="WKWebViewå®ç°"></a>WKWebViewå®ç°</h3><p>è€Œ<code>WKWebView</code>å®ç°ï¼Œéœ€è¦ä½¿ç”¨<code>WKUserScript</code>å’Œ<code>scriptMessageHandler</code>ï¼Œä¸‹é¢ç®€å•ä»‹ç»ä¸‹ï¼Œè¯¦ç»†å®ç°ï¼Œè§Demoã€‚</p>
<p><code>WKWebView</code>çš„<code>UIViewController</code>ä¸­å®ç°å¦‚ä¸‹</p>
<pre><code class="objective-c">/**
 é¡µé¢ä¸­çš„æ‰€æœ‰imgæ ‡ç­¾æ·»åŠ ç‚¹å‡»äº‹ä»¶
 */
- (void)imgAddClickEvent {
    //é˜²æ­¢é¢‘ç¹IOæ“ä½œï¼Œé€ æˆæ€§èƒ½å½±å“
    static NSString *jsSource;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        jsSource = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@&quot;ImgAddClickEvent&quot; ofType:@&quot;js&quot;] encoding:NSUTF8StringEncoding error:nil];
    });
    //æ·»åŠ è‡ªå®šä¹‰çš„è„šæœ¬
    WKUserScript *js = [[WKUserScript alloc] initWithSource:jsSource injectionTime:WKUserScriptInjectionTimeAtDocumentEnd forMainFrameOnly:NO];
    [self.webView.configuration.userContentController addUserScript:js];
    //æ³¨å†Œå›è°ƒ
    [self.webView.configuration.userContentController addScriptMessageHandler:self name:@&quot;imageDidClick&quot;];
}

- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message {
    if ([message.name isEqualToString:@&quot;imageDidClick&quot;]) {
        //ç‚¹å‡»äº†htmlä¸Šçš„å›¾ç‰‡
        NSLog(@&quot;ç‚¹å‡»äº†htmlä¸Šçš„å›¾ç‰‡ï¼Œå‚æ•°ä¸º%@&quot;, message.body);
    }
}
</code></pre>
<p>å½“æˆ‘ç‚¹å‡»è¿™ä¸ªæ ‡ç­¾æ—¶ï¼Œå› ä¸ºæˆ‘æ·»åŠ äº†onclickäº‹ä»¶ï¼Œåœ¨OCç«¯æˆ‘ä¼šæ¥æ”¶åˆ°å›è°ƒã€‚å› æ­¤æ‰“å°å‡ºlog</p>
<p><img src="http://ww3.sinaimg.cn/large/006tNbRwly1ffhp6sn0xnj318k0ie7eq.jpg" alt="0B6DFD21-5707-419E-9918-5AA6792D0CAD"></p>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><blockquote>
<p> ä¸Šé¢æ— è®ºæ˜¯<code>UIWebView</code>è¿˜æ˜¯<code>WKWebView</code>ï¼Œå‚æ•°ä¸­çš„xï¼Œyæ˜¯ä¸åŒ…å«è‡ªå®šä¹‰scrollViewçš„contentInsetçš„ï¼Œå¦‚æœè¦è·å–å›¾ç‰‡åœ¨æ‰‹æœºå±å¹•ä¸Šçš„ä½ç½®ï¼š</p>
<pre><code class="objective-c"> x = x + self.webView.scrollView.contentInset.left;
 y = y + self.webView.scrollView.contentInset.top;
</code></pre>
</blockquote>
<p>æ‹¿åˆ°äº†è¿™äº›ä¿¡æ¯ï¼Œæƒ³å¿…ï¼Œä½ å¯ä»¥å®ç°ä¸€ä¸ªååˆ†å®Œç¾çš„<strong>å›¾ç‰‡é¢„è§ˆæ•ˆæœ</strong>äº†ã€‚</p>
<h2 id="NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img"><a href="#NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img" class="headerlink" title="NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img"></a>NativeåŠ è½½å¹¶ç¼“å­˜H5é¡µé¢ä¸­çš„img</h2><p>å› ä¸ºé¡µé¢ä¸­çš„imgæ ‡ç­¾åŠ è½½å›¾ç‰‡çš„ç½‘ç»œè¯·æ±‚æ˜¯ç”±<code>WebView</code>ç®¡ç†çš„ï¼Œæ‰€ä»¥è¦æƒ³Nativeæ¥ç®¡å›¾ç‰‡çš„ä¸‹è½½ï¼Œåªæœ‰2æ¡è·¯ï¼š</p>
<blockquote>
<ol>
<li>åœ¨é¡µé¢åŠ è½½å‰ï¼ŒæŠŠé¡µé¢ä¸­imgæ ‡ç­¾çš„srcæ¢æˆä¸€å¼ nativeçš„å ä½å›¾æˆ–è€…â€â€ï¼Œå¹¶ä¸”æŠŠimg.srcä¼ é€’åˆ°nativeï¼Œåœ¨nativeä¸‹è½½å›¾ç‰‡æˆ–è€…è¯»å–ç¼“å­˜å®Œæ¯•åï¼Œå†æŠŠç›¸åº”çš„imgæ ‡ç­¾çš„srcè®¾ç½®æˆæœ¬åœ°çš„ï¼Œå¦‚img.src =â€native cache urlâ€ã€‚æ•´ä½“äº¤äº’æ˜¯JS-&gt;Native, Native -&gt; JSã€‚</li>
<li><code>NSURLProtocol</code>æ‹¦æˆª<code>WebView</code>çš„æ‰€æœ‰å›¾ç‰‡è¯·æ±‚ï¼Œäº¤ç”±æˆ‘ä»¬è‡ªå·±ç®¡ç†ã€‚</li>
</ol>
</blockquote>
<p>æ¯”è¾ƒæœ‰å¯è¡Œæ€§çš„æ˜¯æ–¹æ³•2ã€‚ä½†ä¹Ÿåªé™äº<code>UIWebView</code>ã€‚<code>WKWebView</code>ä¸Šç¯‡æ–‡ä¸­è¯´è¿‡ï¼Œè™½ç„¶æœ‰ç§æœ‰Apiï¼Œä½†æ˜¯ç¬”è€…ä¸æ¨èä½¿ç”¨ã€‚</p>
<p>å…ˆè¯´ä¸‹ï¼Œä¸ºä½•æ–¹æ³•1ä¸å¯è¡Œã€‚é¦–å…ˆï¼Œé¡µé¢åŠ è½½å‰ï¼Œæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™å‘¢ï¼Ÿå¦‚æœh5ä¸åšä¿®æ”¹ï¼Œå…¨éƒ¨äº¤ç”±Nativeç«¯å¤„ç†ï¼Œæ˜¯æ²¡æœ‰åŠæ³•ä¿®æ”¹htmlçš„ï¼Œå› ä¸º<code>UIWebView</code>å’Œ<code>WKWebView</code>éƒ½æ²¡æœ‰æä¾›ä¸€ä¸ªApiï¼Œå‘Šè¯‰ä½ htmlæ˜¯è¿™æ ·ï¼Œä½†æ˜¯ä¸Šé¢çš„å›¾ç‰‡æˆ‘è¿˜æ²¡æœ‰åŠ è½½ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯èµ°ä¸é€šçš„ã€‚é™¤éä½ ç”¨<code>loadHTMLString</code>çš„æ–¹æ³•åŠ è½½ï¼ŒåŠ è½½å‰å…ˆæ›¿æ¢imgçš„srcã€‚ä½†æ˜¯<code>loadHTMLString</code>çš„æ–¹æ³•ï¼ŒåˆåŠ è½½ä¸åˆ°Webç«¯çš„jså’Œcssï¼Œåªèƒ½ç”¨äºæœ¬åœ°æ‹¼æ¥å®Œæ•´<code>HTML String</code>çš„æƒ…å†µï¼Œä¸é€‚ç”¨äºä¸€èˆ¬çš„åœºæ™¯ã€‚Soï¼Œè¿™æ¡è·¯æ˜¯èµ°ä¸é€šçš„ï¼Œå±€é™æ€§å¤ªå¤§äº†ã€‚</p>
<p>æ–¹æ³•2çš„æ ¸å¿ƒæ€è·¯å°±æ˜¯æ‹¦æˆªè¯·æ±‚ï¼Œæœ€æ ¸å¿ƒçš„æ˜¯åœ¨ä½ çš„<code>NSURLProtocol</code>å­ç±»ä¸­ï¼Œå®ç°è¿™ä¸ªæ–¹æ³•</p>
<pre><code class="objective-c">+ (BOOL)canInitWithRequest:(NSURLRequest *)request {
    //å¤„ç†è¿‡ä¸å†å¤„ç†
    if ([NSURLProtocol propertyForKey:DAURLProtocolHandledKey inRequest:request]) {
        return NO;
    }
    //æ ¹æ®request headerä¸­çš„ accept æ¥åˆ¤æ–­æ˜¯å¦åŠ è½½å›¾ç‰‡
    /*
    {
     &quot;Accept&quot; = &quot;image/png,image/svg+xml,image/*;q=0.8,*\/*;q=0.5\&quot;;
     &quot;User-Agent&quot; = &quot;Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E269 WebViewDemo/1.0.0&quot;;
    }
     */
    NSDictionary *headers = request.allHTTPHeaderFields;
    NSString *accept = headers[@&quot;Accept&quot;];
    if (accept.length &gt;= @&quot;image&quot;.length &amp;&amp; [accept rangeOfString:@&quot;image&quot;].location != NSNotFound) {
        return YES;
    }
    return NO;
}
</code></pre>
<p>å½“æ‹¦æˆªåˆ°å›¾ç‰‡è¯·æ±‚æ—¶ï¼Œå†åšåç»­çš„å¤„ç†ï¼Œä¸‹é¢å†™ä¸€äº›ä¼ªä»£ç </p>
<pre><code class="objective-c">+ (NSURLRequest *)canonicalRequestForRequest:(NSURLRequest *)request {
    return request;
}
+ (BOOL)requestIsCacheEquivalent:(NSURLRequest *)a toRequest:(NSURLRequest *)b {
    return [super requestIsCacheEquivalent:a toRequest:b];
}
- (void)startLoading {
    NSMutableURLRequest *mutableReqeust = [[self request] mutableCopy];
    //è¿™é‡Œä¹Ÿå¯ä»¥æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„headerï¼Œçœ‹å…·ä½“éœ€æ±‚
    //æ ‡è®°è¯¥requestå·²ç»å¤„ç†è¿‡
    [NSURLProtocol setProperty:@(YES) forKey:DAURLProtocolHandledKey inRequest:mutableReqeust];

    //è¿™é‡ŒNSURLProtocolClientçš„ç›¸å…³æ–¹æ³•éƒ½è¦è°ƒç”¨
    //æ¯”å¦‚ [self.client URLProtocol:self didLoadData:data];
    .....
}
- (void)stopLoading {
    .....
}
</code></pre>
<p>è¿™éƒ¨åˆ†ä»£ç ï¼ŒDemoä¸­å¹¶æ²¡æœ‰å®Œå…¨å®ç°ï¼Œå¦‚æœå°ä¼™ä¼´ä»¬æœ‰å…´è¶£ç ”ç©¶ä¸‹å…·ä½“çš„å®ç°ï¼Œå¯ä»¥å‚è€ƒ<a href="http://www.cocoachina.com/ios/20141225/10765.html" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ï¼Œ ç¬”è€…è¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚</p>
<h2 id="Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰"><a href="#Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰" class="headerlink" title="Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰"></a>Nativeåˆ†äº«H5é¡µé¢åˆ°å¾®ä¿¡ã€QQç­‰</h2><p>è¿™ä¸ªéœ€æ±‚ï¼Œå…¶å®æˆ‘åœ¨å‰é¢çš„æ–‡ç« ä¸­é’ˆå¯¹<code>UIWebView</code>å’Œ<code>WKWebView</code>éƒ½å·²ç»åšäº†å¾ˆè¯¦ç»†çš„ä»‹ç»ã€‚è¿™é‡Œï¼Œç®€å•åˆ†äº«ä¸‹å¦‚ä½•è·å–åˆ†äº«çš„å†…å®¹ã€‚</p>
<p>ä¸€èˆ¬åˆ†äº«åˆ°å¾®ä¿¡æˆ–è€…QQè‡³å°‘éœ€è¦çš„å‚æ•°æ˜¯</p>
<blockquote>
<ol>
<li>Titleï¼ˆä¸»æ ‡é¢˜ï¼‰</li>
<li>Descriptionï¼ˆå‰¯æ ‡é¢˜æˆ–è€…æè¿°ï¼‰</li>
<li>ThumbnailImageï¼ˆç¼©ç•¥å›¾ï¼‰</li>
<li>WebpageUrlï¼ˆh5é¡µé¢çš„é“¾æ¥ï¼‰</li>
</ol>
</blockquote>
<p>è¿™äº›å‚æ•°ï¼Œéƒ½æ€ä¹ˆè·å–å‘¢ï¼Ÿé€šè¿‡OC-&gt;JSçš„æ–¹å¼ï¼Œè·å–ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
<pre><code class="javascript">var title = document.title;
var desc = document.getElementsByTagName(&quot;article&quot;)[0].textContent;     //æˆ–è€… document.body.innerText; æˆ–è€…  document.getElementById(&quot;yourId&quot;).innerText; 
var thumbnailImageUrl = document.getElementsByTagName(&quot;img&quot;)[0].src;    //æˆ–è€…çœ‹éœ€æ±‚å–å“ªä¸ª
var webpageUrl = location.href;
</code></pre>
<p>å…·ä½“å¦‚ä½•ç”¨OCè°ƒç”¨JSè·å–è¿™äº›å€¼ï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œçœ‹è¿‡å‰é¢æ–‡ç« çš„å°ä¼™ä¼´ï¼Œå¯ä»¥è‡ªè¡Œå®ç°ã€‚</p>
<h2 id="Nativeä¸ºH5æä¾›ä¸€å¥—Native-Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰"><a href="#Nativeä¸ºH5æä¾›ä¸€å¥—Native-Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰" class="headerlink" title="Nativeä¸ºH5æä¾›ä¸€å¥—Native Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰"></a>Nativeä¸ºH5æä¾›ä¸€å¥—Native Apiï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®å°ç¨‹åºï¼‰</h2><p>å¾ˆå¤šæ—¶å€™ï¼ŒNativeä¸H5äº¤äº’çš„æ·±äº†ï¼Œå¿…å®šä¼šæœ‰ä¸€äº›æ›´æ·±å±‚æ¬¡çš„éœ€æ±‚ã€‚æ¯”å¦‚h5æƒ³æ§åˆ¶é¡µé¢çš„popã€pushã€presentï¼Œæƒ³è°ƒç”¨Nativeçš„Shareï¼Œæƒ³è°ƒç”¨Nativeçš„æ‰«æäºŒç»´ç åŠŸèƒ½ï¼Œè·å–æ‰«æç»“æœâ€¦â€¦</p>
<p>é‚£ä¹ˆè¿‘åŠå¹´æ¯”è¾ƒğŸ”¥çš„å°ç¨‹åºï¼Œå¾®ä¿¡æä¾›çš„ä¸€äº›Apiï¼ˆæ‰«ç ã€é€‰æ‹©ç…§ç‰‡ç­‰ï¼‰éƒ½æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œnativeæä¾›çš„ã€‚</p>
<p>ç¬”è€…ä½œä¸ºæ”¯ä»˜å®å°ç¨‹åºï¼ˆå°šæœªå‘å¸ƒï¼‰çš„å†…æµ‹ç”¨æˆ·ä¹‹ä¸€ï¼Œä¹Ÿæ¥è§¦äº†æ”¯ä»˜å®å°ç¨‹åºï¼Œå…¶ä¸­ä¹Ÿæœ‰å¾ˆå¤šApiæ˜¯nativeæä¾›çš„ã€‚</p>
<p>å…¶å®è¿™å°±æ¶‰åŠåˆ°ä¸€ä¸ªå®Œæ•´çš„Nativeä¸JSäº¤äº’çš„æµç¨‹ï¼Œ<strong>ä»JS-&gt;Nativeåˆ°Native-&gt;JS</strong>ã€‚ä¹Ÿå°±æ˜¯å‰é¢ä»‹ç»è¿‡çš„ï¼Œå¼‚æ­¥å›è°ƒç»“æœã€‚è¿™ä¸ªä¸å±€é™äºiOSï¼ŒAndroidä¹Ÿæ˜¯åŒæ ·çš„ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºH5æä¾›ä¸€å¥—Apiï¼Œé‚£è‡ªç„¶Apiæ˜¯æš´éœ²ç»™jsçš„ï¼Œæ‰€ä»¥è¿™äº›Apiä¹Ÿæ˜¯jsçš„ã€‚ç¬”è€…å°è£…äº†ä¸€ä¸ªæ¥å£æ–‡ä»¶ï¼š<code>NativeApi.js</code>ï¼ˆåœ¨æœ€æ–°çš„<a href="https://github.com/DarkAngel7/Demos-WebViewDemo" target="_blank" rel="external">Demo</a>ä¸­æœ‰ï¼‰ã€‚ä¸‹é¢é’ˆå¯¹ä¸€äº›éœ€æ±‚ï¼Œåˆ†æä¸‹å°è£…å’Œå®ç°ã€‚å…¶ä¸­ç”¨åˆ°äº†<strong>jsé—­åŒ…</strong>ï¼Œéœ€è¦ä¸€ç‚¹jsçŸ¥è¯†ã€‚</p>
<h3 id="åˆ†äº«"><a href="#åˆ†äº«" class="headerlink" title="åˆ†äº«"></a>åˆ†äº«</h3><p>å‰é¢çš„æ–‡ç« ä¸­ï¼Œç¬”è€…æœ€å¸¸ä¸¾çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯åˆ†äº«ï¼ŒNativeä¸ºH5æä¾›åŸç”Ÿçš„åˆ†äº«æ–¹æ³•ï¼Œh5è°ƒç”¨åå¯ä»¥è·å–åˆ†äº«ç»“æœï¼ˆæˆåŠŸorå¤±è´¥ï¼‰ã€‚è¿™é‡Œé’ˆå¯¹åˆ†äº«è¿™ä¸ªå¦‚ä½•å®ç°ï¼Œå°±ä¸èµ˜è¿°äº†ã€‚ç¬”è€…ç›´æ¥è´´ä¸Šé€‚ç”¨äº<code>WKWebView</code>çš„<code>js</code>ä»£ç ã€‚</p>
<pre><code class="javascript">/**
 * Nativeä¸ºH5æä¾›çš„Apiæ¥å£
 *
 * @type {jså¯¹è±¡}
 */
var DANativeApi = (function() {

    var NativeApi = {
        /**
         * åˆ†äº«
         * @param  {jså¯¹è±¡} shareInfo åˆ†äº«ä¿¡æ¯å’Œå›è°ƒ
         * @return {void}           æ— åŒæ­¥è¿”å›å€¼ï¼Œå¼‚æ­¥è¿”å›åˆ†äº«ç»“æœ true or false
         */
        share: function(shareInfo) {
            if (shareInfo == undefined || shareInfo == null || typeof(shareInfo) !== &quot;object&quot;) {
                alert(&quot;å‚æ•°&quot; + JSON.stringify(shareInfo) + &quot;ä¸åˆæ³•&quot;);
            } else {
                alert(&quot;åˆ†äº«çš„å‚æ•°ä¸º&quot; + JSON.stringify(shareInfo));
            }
            //è°ƒç”¨nativeç«¯
            _nativeShare(shareInfo);
        }
    }

    //ä¸‹é¢æ˜¯ä¸€äº›ç§æœ‰å‡½æ•°
    /**
     * Nativeç«¯å®ç°ï¼Œé€‚ç”¨äºWKWebViewï¼ŒUIWebViewå¦‚ä½•å®ç°ï¼Œå°ä¼™ä¼´è‡ªå·±åŠ¨è„‘ç­‹å§~
     * @param  {jså¯¹è±¡} shareInfo åˆ†äº«çš„ä¿¡æ¯å’Œå›è°ƒ
     * @return {void}           æ— åŒæ­¥è¿”å›å€¼ï¼Œå¼‚æ­¥è¿”å›
     */
    function _nativeShare(shareInfo) {
        //ç”¨äºWKWebViewï¼Œå› ä¸ºWKWebViewå¹¶æ²¡æœ‰åŠæ³•æŠŠjs functionä¼ é€’è¿‡å»ï¼Œå› æ­¤éœ€è¦ç‰¹æ®Šå¤„ç†ä¸€ä¸‹
        //æŠŠjs functionè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œocç«¯è°ƒç”¨æ—¶ (&lt;js function string&gt;)(true); å³å¯
        //å¦‚æœæœ‰å›è°ƒå‡½æ•°ï¼Œä¸”ä¸ºfunction
        var callbackFunction = shareInfo.result;
        if (callbackFunction != undefined &amp;&amp; callbackFunction != null &amp;&amp; typeof(callbackFunction) === &quot;function&quot;) {
            shareInfo.result = callbackFunction.toString();
        }
        //js -&gt; oc 
        // è‡³äºAndroidç«¯ï¼Œä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚ window.jsInterface.nativeShare(JSON.stringify(shareInfo));
        window.webkit.messageHandlers.nativeShare.postMessage(shareInfo);
    }

    //é—­åŒ…ï¼ŒæŠŠApiå¯¹è±¡è¿”å›
    return NativeApi;
})();

/*

//è°ƒç”¨æ—¶ï¼Œåˆ†äº«
DANativeApi.share({
    title: document.title,
    desc: &quot;&quot;,
    url: location.href,
    imgUrl: &quot;&quot;,
    result: function(res) {
        // body...
        alert(&quot;åˆ†äº«ç»“æœä¸ºï¼š&quot; + JSON.stringify(res));
    }
});

 */
</code></pre>
<p>Nativeç«¯ä¸è´´äº†ï¼Œå°ä¼™ä¼´ä»¬çœ‹Demoå§ã€‚</p>
<h3 id="ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº"><a href="#ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº" class="headerlink" title="ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº"></a>ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº</h3><p>è¿™é‡Œç¬”è€…å†ä¸¾ä¸ªä»é€šè®¯å½•é€‰æ‹©è”ç³»äººçš„ä¾‹å­ï¼Œä»jsåˆ°nativeï¼Œå†ä»nativeåˆ°jsã€‚</p>
<p>é¦–å…ˆjsç«¯ï¼Œæ·»åŠ å¦‚ä¸‹å®ç°</p>
<pre><code class="javascript">/**
 * Nativeä¸ºH5æä¾›çš„Apiæ¥å£
 *
 * @type {jså¯¹è±¡}
 */
var DANativeApi = (function() {

    var NativeApi = {
        /**
         * ä»é€šè®¯å½•é€‰æ‹©è”ç³»äºº
         * @return {void} æ— åŒæ­¥è¿”å›å€¼ï¼Œå¼‚æ­¥è¿”å›é€‰æ‹©çš„ç»“æœ
         */
        choosePhoneContact: function(param) {
            //å…·ä½“æ˜¯å¦éœ€è¦åˆ¤æ–­
            //è°ƒç”¨nativeç«¯
            _nativeChoosePhoneContact(param);
        }
    }

    //ä¸‹é¢æ˜¯ä¸€äº›ç§æœ‰å‡½æ•°
    /**
     * Nativeç«¯å®ç°é€‰æ‹©è”ç³»äººï¼Œå¹¶å¼‚æ­¥è¿”å›ç»“æœ
     * @param  {[type]} param [description]
     * @return {[type]}       [description]
     */
    function _nativeChoosePhoneContact(param) {
        var callbackFunction = param.completion;
        if (callbackFunction != undefined &amp;&amp; callbackFunction != null &amp;&amp; typeof(callbackFunction) === &quot;function&quot;) {
            param.completion = callbackFunction.toString();
        }
        //js -&gt; oc 
        window.webkit.messageHandlers.nativeChoosePhoneContact.postMessage(param);
    }

    //é—­åŒ…ï¼ŒæŠŠApiå¯¹è±¡è¿”å›
    return NativeApi;
})();

/*
//é€‰æ‹©è”ç³»äºº
DANativeApi.choosePhoneContact({
    completion: function(res) {
        alert(&quot;é€‰æ‹©è”ç³»äººçš„ç»“æœä¸ºï¼š&quot; + JSON.stringify(res));
    }
});
 */
</code></pre>
<p>OCç«¯ä¾ç„¶åŠ è½½æ­¤æ–‡ä»¶ï¼Œå¹¶æ³¨å†Œhandler</p>
<pre><code class="objective-c">/**
 æ·»åŠ nativeç«¯çš„api
 */
- (void)addNativeApiToJS
{
    //é˜²æ­¢é¢‘ç¹IOæ“ä½œï¼Œé€ æˆæ€§èƒ½å½±å“
    static NSString *nativejsSource;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        nativejsSource = [NSString stringWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@&quot;NativeApi&quot; ofType:@&quot;js&quot;] encoding:NSUTF8StringEncoding error:nil];
    });
    //æ·»åŠ è‡ªå®šä¹‰çš„è„šæœ¬
    WKUserScript *js = [[WKUserScript alloc] initWithSource:nativejsSource injectionTime:WKUserScriptInjectionTimeAtDocumentStart forMainFrameOnly:NO];
    [self.webView.configuration.userContentController addUserScript:js];
    //æ³¨å†Œå›è°ƒ
    [self.webView.configuration.userContentController addScriptMessageHandler:self name:@&quot;nativeChoosePhoneContact&quot;];
}

#pragma mark - WKScriptMessageHandler  js -&gt; oc

- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message {
   //é€‰æ‹©è”ç³»äºº
   if ([message.name isEqualToString:@&quot;nativeChoosePhoneContact&quot;]) {
        NSLog(@&quot;æ­£åœ¨é€‰æ‹©è”ç³»äºº&quot;);

        [self selectContactCompletion:^(NSString *name, NSString *phone) {
            NSLog(@&quot;é€‰æ‹©å®Œæˆ&quot;);
            //è¯»å–js functionçš„å­—ç¬¦ä¸²
            NSString *jsFunctionString = message.body[@&quot;completion&quot;];
            //æ‹¼æ¥è°ƒç”¨è¯¥æ–¹æ³•çš„jså­—ç¬¦ä¸²
            NSString *callbackJs = [NSString stringWithFormat:@&quot;(%@)({name: &#39;%@&#39;, mobile: &#39;%@&#39;});&quot;, jsFunctionString, name, phone];
            //æ‰§è¡Œå›è°ƒ
            [self.webView evaluateJavaScript:callbackJs completionHandler:^(id _Nullable result, NSError * _Nullable error) {

            }];
        }];
    }
}
</code></pre>
<p>å…·ä½“å›è°ƒæ–¹å¼ï¼Œåœ¨ä¹‹å‰çš„<code>WKWebView</code>ä¸­ï¼Œè®²è¿‡äº†ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œé€‰æ‹©è”ç³»äººç”¨çš„æ˜¯<code>Contacts</code>æ¡†æ¶ï¼Œå…·ä½“çš„å°ä¼™ä¼´å¯ä»¥çœ‹Demoã€‚</p>
<p>æ•´ä½“æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="http://ww2.sinaimg.cn/large/006tNbRwly1ffispvqvqeg308z0g0alz.gif" alt="new"></p>
<h3 id="æ‰«æäºŒç»´ç "><a href="#æ‰«æäºŒç»´ç " class="headerlink" title="æ‰«æäºŒç»´ç "></a>æ‰«æäºŒç»´ç </h3><p>ç›¸ä¿¡çœ‹è¿‡ä»é€šè®¯å½•é€‰æ‹©è”ç³»äººçš„å®ç°ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥è‡ªè¡Œå®ç°æ‰«æäºŒç»´ç äº†å§~ å¿«åŠ¨æ‰‹å°è¯•ä¸€ä¸‹å§~</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ¬æ–‡ç»™å°ä¼™ä¼´ä»¬ä»‹ç»äº†ä¸‹Safariè°ƒè¯•ï¼Œä»¥åŠå…¶å…·ä½“è¿ç”¨ï¼Œå¹¶ä¸”åˆ†äº«äº†å®é™…åº”ç”¨ä¸­ä¸€äº›éœ€æ±‚çš„å®ç°æ–¹å¼ã€‚</p>
<p>ç»“åˆå‰é¢çš„ä¸¤ç¯‡æ–‡ç« ï¼Œ ç›¸ä¿¡ç°åœ¨å°ä¼™ä¼´ä»¬ä¸€å®šå¯¹<code>WebView</code>æœ‰ç›¸å½“æ·±åˆ»çš„ç†è§£äº†å§ã€‚é‚£ä¹ˆï¼Œæœ¬ç³»åˆ—æ–‡ç« ä¹Ÿå‘Šä¸€æ®µè½äº†ï¼Œå…·ä½“æœ‰é—®é¢˜çš„è¯ï¼Œæ¬¢è¿æé—®ã€‚</p>

    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Dark Angel</h4>
    <p>iOSç•Œçš„ä½è°ƒæ¢ç´¢è€…</p>
</section>
    <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"></a><a href="#" class="bds_tsina" data-cmd="tsina"></a><a href="#" class="bds_tqq" data-cmd="tqq"></a><a href="#" class="bds_renren" data-cmd="renren"></a><a href="#" class="bds_weixin" data-cmd="weixin"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdPic":"","bdStyle":"0","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"åˆ†äº«åˆ°ï¼š","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <span class="icon-logo">â€¢</span>
    
    <a class="older-posts" href="/2017/05/10/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸­ï¼‰/">
        iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸­ï¼‰ â†’
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    
    	<!-- å¤šè¯´è¯„è®ºæ¡† start -->
ã€€	<div class="ds-thread" data-thread-key="2017/05/11/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰/" data-title="iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰" data-url="http://blog.darkangel7.com/2017/05/11/iOSä¸­UIWebViewä¸WKWebViewã€JavaScriptä¸OCäº¤äº’ã€Cookieç®¡ç†çœ‹æˆ‘å°±å¤Ÿï¼ˆä¸‹ï¼‰/" data-auth-key="1"</div>	
	<!-- å¤šè¯´è¯„è®ºæ¡† end -->
	<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
	<script type="text/javascript">
		var duoshuoQuery = {short_name:"darkangel"};
		(function() {
			var ds = document.createElement('script');
			ds.type = 'text/javascript';ds.async = true;
			ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
			ds.charset = 'UTF-8';
			(document.getElementsByTagName('head')[0] 
		 	|| document.getElementsByTagName('body')[0]).appendChild(ds);
		})();
	</script>
	<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
    
</div>

</main>


      
<footer class="site-footer">
  
  <a class="subscribe icon-feed" href="/atom.xml"><span class="tooltip">Subscribe!</span></a>
  
  <div class="inner">
     <section class="copyright">åŸåˆ›æ–‡ç« ï¼Œç‰ˆæƒå£°æ˜ï¼šç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 2.5</section>
     <section class="copyright"><a href="/">Dark Angel</a> &copy; 2016 &bull; All Rights Reserved.</section>
     <section class="poweredby">Powered By Hexo</section>
  </div>
</footer>

      <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/8.5/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archives"><span>Archive</span></a>

          <a class="icon-wiki"  href="https://github.com/DarkAngel7"><span>Github</span></a>

          <a class="icon-Favorites"  href="/atom.xml"><span>Rss</span></a>

</nav>

</div>
</body>
</html>
